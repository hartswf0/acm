<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE ANALOG RADAR: DEW-Line Deck Press</title>
    <style>
        :root {
            --bg: #ffffff;
            --ui-bg: #fdfdfd;
            --ink: #000000;
            --card-w: 2.5in;
            --card-h: 3.5in;
            --safe: 0.15in;
        }

        * {
            box-sizing: border-box;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--ui-bg);
            color: var(--ink);
            font-size: 14px;
        }

        /* --- UI CHROME --- */
        nav {
            display: flex;
            background: #000;
            color: white;
            padding: 0.5rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            gap: 8px;
            overflow-x: auto;
            border-bottom: 3px solid #000;
        }

        nav button {
            background: #222;
            color: #eee;
            border: 1px solid #444;
            padding: 8px 14px;
            cursor: pointer;
            font-size: 10px;
            text-transform: uppercase;
            font-weight: bold;
            white-space: nowrap;
        }

        nav button.active {
            background: white;
            color: black;
            border-color: white;
        }

        .view-panel {
            display: none;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .view-panel.active {
            display: block;
        }

        /* --- ONBOARDING / GUIDE STYLES --- */
        .guide-section {
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .guide-section h2 {
            border-bottom: 3px solid #000;
            padding-bottom: 5px;
            text-transform: uppercase;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .guide-section h3 {
            text-transform: uppercase;
            font-size: 0.9rem;
            margin-top: 25px;
            letter-spacing: 1px;
        }

        .walkthrough-box {
            background: #000;
            color: #fff;
            padding: 24px;
            border-radius: 2px;
            margin: 20px 0;
            font-family: ui-monospace, monospace;
            border: 1px solid #333;
        }

        .walkthrough-step {
            border-left: 1px solid #444;
            padding-left: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .walkthrough-step::before {
            content: "⎈";
            position: absolute;
            left: -8px;
            background: #000;
            height: 16px;
            width: 16px;
            text-align: center;
            font-size: 12px;
            top: 0;
        }

        .walkthrough-step b {
            color: #888;
            text-transform: uppercase;
            font-size: 0.75rem;
            display: block;
            margin-bottom: 4px;
        }

        .theory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .theory-item {
            border: 1px solid #eee;
            padding: 15px;
            background: #fff;
        }

        .theory-item i {
            display: block;
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-style: normal;
        }

        /* --- CARD DESIGN SYSTEM --- */
        .card-face {
            width: var(--card-w);
            height: var(--card-h);
            background: white;
            border: 1px solid black;
            display: flex;
            flex-direction: column;
            padding: var(--safe);
            position: relative;
            overflow: hidden;
        }

        .card-id {
            font-family: monospace;
            font-size: 9px;
            position: absolute;
            top: 10px;
            right: 10px;
            letter-spacing: 1px;
        }

        .card-badge {
            font-size: 9px;
            font-weight: bold;
            border: 1.5px solid black;
            padding: 1px 5px;
            width: fit-content;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .card-title {
            font-weight: 900;
            font-size: 12px;
            text-transform: uppercase;
            margin-bottom: 8px;
            line-height: 1;
            letter-spacing: -0.2px;
        }

        .card-body {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: "Georgia", serif;
            font-size: 15px;
            text-align: center;
            line-height: 1.4;
            font-weight: 500;
        }

        .card-footer {
            font-size: 8px;
            font-weight: bold;
            text-align: right;
            border-top: 1px solid black;
            padding-top: 4px;
            margin-top: 8px;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .card-back {
            background: white;
            color: black;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .back-logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 2px;
        }

        .back-text {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 900;
            border-top: 2px solid black;
            padding-top: 4px;
            margin-bottom: 15px;
        }

        .back-type-label {
            font-size: 8px;
            font-weight: bold;
            text-transform: uppercase;
            border: 1px solid black;
            padding: 2px 8px;
            letter-spacing: 1px;
        }

        /* --- PRINT LAYOUTS (PAGINATED) --- */
        .print-page {
            display: grid;
            grid-template-columns: var(--card-w) var(--card-w);
            grid-template-rows: var(--card-h) var(--card-h);
            gap: 0;
            justify-content: center;
            width: 8.5in;
            margin: 0 auto 0.5in auto;
            page-break-after: always;
        }

        .fold-grid {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .fold-pair {
            display: flex;
            margin-bottom: 10px;
            page-break-inside: avoid;
        }

        /* --- MOBILE VIEWER --- */
        #mobile-view {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }

        .mobile-card-stage {
            margin: 20px 0;
            perspective: 1000px;
        }

        .mobile-flipper {
            width: var(--card-w);
            height: var(--card-h);
            margin: 0 auto;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.4s;
            cursor: pointer;
        }

        .mobile-flipper.flipped {
            transform: rotateY(180deg);
        }

        .mobile-flipper .card-face {
            position: absolute;
            backface-visibility: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border-width: 2px;
        }

        .mobile-flipper .card-back {
            transform: rotateY(180deg);
        }

        .mobile-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .btn-action {
            padding: 18px;
            font-weight: bold;
            border: 2px solid black;
            background: black;
            color: white;
            cursor: pointer;
            font-size: 12px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .btn-secondary {
            background: white;
            color: black;
        }

        /* Utils */
        .export-box {
            font-family: monospace;
            background: #fff;
            border: 1px solid #ddd;
            padding: 10px;
            font-size: 10px;
            white-space: pre-wrap;
            overflow: auto;
            max-height: 400px;
            margin-top: 10px;
        }

        @media print {

            nav,
            .checklist,
            .mobile-controls,
            .export-box,
            .filter-bar,
            .guide-section,
            #deck-counter,
            #game-info,
            .data-header {
                display: none !important;
            }

            body {
                background: white;
            }

            .view-panel {
                display: block !important;
                padding: 0 !important;
            }

            .print-page {
                border: none;
                margin: 0;
            }

            .card-face {
                border: 1px dashed black;
            }
        }
    </style>
</head>

<body>

    <nav id="top-nav">
        <button onclick="showView(event, 'guide')" class="active">Tactical Manual</button>
        <button onclick="showView(event, 'mobile')">Mobile Probe</button>
        <button onclick="showView(event, 'print-fold')">2-Up Foldable</button>
        <button onclick="showView(event, 'print-fronts')">4-Up Fronts</button>
        <button onclick="showView(event, 'print-backs')">4-Up Backs</button>
        <button onclick="showView(event, 'data')">Export Data</button>
    </nav>

    <!-- GUIDE PANEL -->
    <div id="guide" class="view-panel active">
        <div class="guide-section">
            <h2><span>⌬</span> THE ANALOG RADAR: OPERATIONAL MANUAL</h2>
            <p>You are wielding a <b>Cybernetic Feedback Loop</b>. The DEW-Line (Distant Early Warning) deck is an
                analog computer designed to run on the human nervous system. It does not provide answers; it provides
                <b>Friction</b>. In a world of frictionless data, the only way to recognize a pattern is to interrupt
                it.</p>

            <h3>The Cybernetic Protocol</h3>
            <p>Traditional problem solving follows a linear path (Input ⇢ Logic ⇢ Output). The Management Game follows a
                <b>Probe Loop</b>:</p>

            <div class="walkthrough-box">
                <div class="walkthrough-step">
                    <b>01. THE CALIBRATION</b>
                    State your problem in one sentence. Avoid jargon. Focus on the <i>feeling</i> of the blockage.
                    <i>Example: "The brand feels stagnant despite the data saying we are growing."</i>
                </div>
                <div class="walkthrough-step">
                    <b>02. THE DISRUPTION</b>
                    Shuffle the deck. This is not ritual; it is <b>Stochastic Ingestion</b>. You are introducing white
                    noise to clear the signal.
                </div>
                <div class="walkthrough-step">
                    <b>03. THE ENCOUNTER</b>
                    Draw a card. Read it aloud. Do not look for a literal connection.
                    <i>Drawn: "The stripper puts the audience on."</i>
                </div>
                <div class="walkthrough-step">
                    <b>04. THE PATTERN RECOGNITION</b>
                    Apply the card as a structural lens.
                    <i>Synthesis: "Putting the audience on" means involvement. Is our growth stagnant because we are
                        treating customers as 'viewers' rather than 'performers' in our brand story?</i>
                </div>
            </div>

            <h3>Strategic Mindsets</h3>
            <div class="theory-grid">
                <div class="theory-item">
                    <i>⎈</i>
                    <b>SIGNAL vs NOISE</b>
                    Linear thinking filters out "noise" to find "signal." The DEW-Line assumes the noise IS the signal
                    you've been ignoring.
                </div>
                <div class="theory-item">
                    <i>⍼</i>
                    <b>ACOUSTIC SPACE</b>
                    Books are visual (linear). The Deck is acoustic (simultaneous). Information hits you from all
                    directions at once.
                </div>
                <div class="theory-item">
                    <i>⧖</i>
                    <b>LATERAL DRIFT</b>
                    If a door is locked, stop pushing. Walk sideways. The cards force the sidestep.
                </div>
            </div>

            <h3>Daily Rituals</h3>
            <p><b>THE MORNING PROBE:</b> Draw one card before checking email. Let that card color every interaction for
                the day.</p>
            <p><b>THE STALLED MEETING:</b> If a group cannot decide, place the deck in the center. The first person to
                speak draws. The meeting becomes a workshop on that card.</p>
        </div>
    </div>

    <!-- MOBILE VIEW -->
    <div id="mobile" class="view-panel">
        <div id="mobile-view">
            <div id="game-info"
                style="font-size: 11px; margin-bottom: 10px; font-weight: bold; letter-spacing: 2px; text-transform: uppercase;">
                [ PROBE INTERFACE ]</div>
            <div class="mobile-card-stage">
                <div id="mobile-flipper" class="mobile-flipper" onclick="this.classList.toggle('flipped')">
                    <!-- Content via JS -->
                </div>
            </div>
            <div class="mobile-controls">
                <button class="btn-action" onclick="app.draw()">DRAW PROBE</button>
                <button class="btn-action btn-secondary" onclick="app.shuffle()">SHUFFLE</button>
            </div>
            <div id="deck-counter"
                style="margin-top: 15px; font-size: 11px; font-family: ui-monospace, monospace; letter-spacing: 1px;">
                UNIT 000 / 120</div>
        </div>
    </div>

    <!-- PRINT 2-UP FOLDABLE -->
    <div id="print-fold" class="view-panel">
        <div class="checklist" style="margin-bottom:20px; border:1px solid #000; padding:10px;">
            <strong>FOLDABLE:</strong> Cut horizontal pairs, fold on the center line. Best for single-sided paper.</div>
        <div id="fold-grid" class="fold-grid"></div>
    </div>

    <!-- PRINT 4-UP FRONTS -->
    <div id="print-fronts" class="view-panel">
        <div id="fronts-container"></div>
    </div>

    <!-- PRINT 4-UP BACKS -->
    <div id="print-backs" class="view-panel">
        <div id="backs-container"></div>
    </div>

    <!-- DATA EXPORT -->
    <div id="data" class="view-panel">
        <h3 class="data-header">Source JSON</h3>
        <div id="json-export" class="export-box"></div>
    </div>

    <script id="deck-data" type="application/json">
[
    {"id":"000", "type":"META", "icon":"◎", "title":"THE ORACLE", "body":"Marshall McLuhan (1911-1980). Media theorist. His central thesis: The medium is the message. The artist is the Distant Early Warning system of the race.", "footer":"ARCHIVAL SOURCE"},
    {"id":"001", "type":"META", "icon":"◎", "title":"THE PROTOCOL", "body":"1. Define the Problem. 2. Shuffle. 3. Draw a Probe. 4. Synthesize the metaphor. Do not seek logic; seek pattern. Humour is the best probe.", "footer":"RULES OF ENGAGEMENT"},
    {"id":"002", "type":"META", "icon":"◎", "title":"THE ALGORITHM", "body":"Noise is unorganized signal. Randomization forces the brain out of linear grooves into the acoustic space of the electric age. This is a paper computer.", "footer":"GAME THEORY"},
    {"id":"003", "type":"META", "icon":"◎", "title":"THE SIMULATION", "body":"Example: A product launch is failing. Draw: 'The user is the content.' Insight: We are selling a tool, but the value is in how the user transforms themselves with it.", "footer":"WALKTHROUGH"},
    {"id":"004", "type":"CORE", "icon":"◈", "title":"DIAMONDS-10", "body":"The medium is the message.", "footer":"Marshall McLuhan"},
    {"id":"005", "type":"CORE", "icon":"◈", "title":"DIAMONDS-J", "body":"To the blind all things are sudden.", "footer":"Aphorism"},
    {"id":"006", "type":"CORE", "icon":"◈", "title":"DIAMONDS-7", "body":"Thanks for the mammaries.", "footer":"McLuhan (Pun)"},
    {"id":"007", "type":"CORE", "icon":"◈", "title":"DIAMONDS-5", "body":"Silence is all the sounds of the environment at once.", "footer":"John Cage"},
    {"id":"008", "type":"CORE", "icon":"◈", "title":"DIAMONDS-3", "body":"Should old Aquinas be forgot?", "footer":"Marshall McLuhan"},
    {"id":"009", "type":"CORE", "icon":"◈", "title":"SPADES-5", "body":"Propaganda is any culture in action.", "footer":"Jacques Ellul"},
    {"id":"010", "type":"CORE", "icon":"◈", "title":"SPADES-4", "body":"When all is said and done more will have been said than done.", "footer":"Aphorism"},
    {"id":"011", "type":"CORE", "icon":"◈", "title":"HEARTS-8", "body":"A man wrapped up in himself makes a small package.", "footer":"Aphorism"},
    {"id":"012", "type":"CORE", "icon":"◈", "title":"HEARTS-5", "body":"Is there a life before death?", "footer":"Aphorism"},
    {"id":"013", "type":"CORE", "icon":"◈", "title":"CLUBS-Q", "body":"Hell hath no music like a woman playing second fiddle.", "footer":"Aphorism"},
    {"id":"014", "type":"PROBE", "icon":"∿", "title":"ANTENNA", "body":"Artists are the antennae of the race.", "footer":"Ezra Pound"},
    {"id":"015", "type":"PROBE", "icon":"∿", "title":"SKIN", "body":"The stripper puts the audience on.", "footer":"McLuhan"},
    {"id":"016", "type":"PROBE", "icon":"∿", "title":"CANNIBAL", "body":"How do you like kids? Well cooked.", "footer":"W.C. Fields"},
    {"id":"017", "type":"FLUX", "icon":"⊗", "title":"SHADOW", "body":"Do not come out of your shadow.", "footer":"Performance Score"},
    {"id":"018", "type":"FLUX", "icon":"⊗", "title":"SWALLOW", "body":"Do not swallow.", "footer":"Performance Score"},
    {"id":"019", "type":"FLUX", "icon":"⊗", "title":"FRAUD", "body":"Look like a fraud.", "footer":"Performance Score"},
    {"id":"020", "type":"FLUX", "icon":"⊗", "title":"LEAF", "body":"Quiver like a leaf.", "footer":"Performance Score"},
    {"id":"021", "type":"PROBE", "icon":"∿", "title":"FUTURE", "body":"We march backwards into the future.", "footer":"McLuhan"},
    {"id":"022", "type":"PROBE", "icon":"∿", "title":"EARTH", "body":"Spaceship Earth.", "footer":"B. Fuller"},
    {"id":"023", "type":"PROBE", "icon":"∿", "title":"CREDIT", "body":"Money is the poor man's credit card.", "footer":"McLuhan"},
    {"id":"024", "type":"PROBE", "icon":"∿", "title":"MOTHER", "body":"Invention is the mother of necessities.", "footer":"McLuhan"},
    {"id":"025", "type":"PROBE", "icon":"∿", "title":"TIME", "body":"Time has ceased, space has vanished.", "footer":"McLuhan"},
    {"id":"026", "type":"PROBE", "icon":"∿", "title":"FEEDBACK", "body":"Feedback is the loop of the future.", "footer":"Cybernetic Theory"},
    {"id":"027", "type":"PROBE", "icon":"∿", "title":"CONTENT", "body":"The content of a movie is a novel.", "footer":"McLuhan"},
    {"id":"028", "type":"PROBE", "icon":"∿", "title":"USER", "body":"The user is the content.", "footer":"McLuhan"},
    {"id":"029", "type":"PROBE", "icon":"∿", "title":"PRINT", "body":"Print is the technology of individualism.", "footer":"McLuhan"},
    {"id":"030", "type":"PROBE", "icon":"∿", "title":"PRIMITIVE", "body":"We are the primitives of a new culture.", "footer":"McLuhan"},
    {"id":"031", "type":"PROBE", "icon":"∿", "title":"WAR", "body":"War is education.", "footer":"McLuhan"},
    {"id":"032", "type":"FLUX", "icon":"⊗", "title":"SILENCE", "body":"Do not speak.", "footer":"Performance Score"},
    {"id":"033", "type":"FLUX", "icon":"⊗", "title":"NAIVE", "body":"With inane but inappropriate naivety.", "footer":"Performance Score"},
    {"id":"034", "type":"FLUX", "icon":"⊗", "title":"WILLOW", "body":"Weep like a willow.", "footer":"Performance Score"},
    {"id":"035", "type":"FLUX", "icon":"⊗", "title":"MENTAL", "body":"Slow down mentally.", "footer":"Performance Score"},
    {"id":"036", "type":"FLUX", "icon":"⊗", "title":"IMMOBILE", "body":"White and immobile.", "footer":"Performance Score"},
    {"id":"037", "type":"FLUX", "icon":"⊗", "title":"PAINFUL", "body":"Outward, painfully.", "footer":"Performance Score"},
    {"id":"038", "type":"FLUX", "icon":"⊗", "title":"FINGERS", "body":"With tears in your fingers.", "footer":"Performance Score"},
    {"id":"039", "type":"FLUX", "icon":"⊗", "title":"BORED", "body":"From a distance, bored.", "footer":"Performance Score"},
    {"id":"040", "type":"FLUX", "icon":"⊗", "title":"ALONE", "body":"Courageously easy and obligingly alone.", "footer":"Performance Score"},
    {"id":"041", "type":"FLUX", "icon":"⊗", "title":"FOOD", "body":"Do not eat too much.", "footer":"Performance Score"},
    {"id":"042", "type":"FLUX", "icon":"⊗", "title":"OUT", "body":"Do not go out.", "footer":"Performance Score"},
    {"id":"043", "type":"FLUX", "icon":"⊗", "title":"FACE", "body":"Do not look disagreeable.", "footer":"Performance Score"},
    {"id":"044", "type":"FLUX", "icon":"⊗", "title":"DULL", "body":"Even duller if you can.", "footer":"Performance Score"},
    {"id":"045", "type":"FLUX", "icon":"⊗", "title":"WHITE", "body":"Even whiter if possible.", "footer":"Performance Score"},
    {"id":"046", "type":"FLUX", "icon":"⊗", "title":"WEAK", "body":"Fall till you are weak.", "footer":"Performance Score"},
    {"id":"047", "type":"FLUX", "icon":"⊗", "title":"FLOOR", "body":"Flat on the floor.", "footer":"Performance Score"},
    {"id":"048", "type":"FLUX", "icon":"⊗", "title":"HOLD", "body":"Hold back.", "footer":"Performance Score"},
    {"id":"049", "type":"FLUX", "icon":"⊗", "title":"LAUGH", "body":"Laugh without anyone knowing.", "footer":"Performance Score"},
    {"id":"050", "type":"FLUX", "icon":"⊗", "title":"TOOTHACHE", "body":"Like a nightingale with toothache.", "footer":"Performance Score"},
    {"id":"051", "type":"FLUX", "icon":"⊗", "title":"PRIEST", "body":"Pale and priest-like.", "footer":"Performance Score"},
    {"id":"052", "type":"FLUX", "icon":"⊗", "title":"SLOW", "body":"Slow and painful.", "footer":"Performance Score"},
    {"id":"053", "type":"FLUX", "icon":"⊗", "title":"BONES", "body":"With your bones dry and distant.", "footer":"Performance Score"},
    {"id":"054", "type":"FLUX", "icon":"⊗", "title":"HANDS", "body":"With your head between your hands.", "footer":"Performance Score"},
    {"id":"055", "type":"PROBE", "icon":"∿", "title":"RADAR", "body":"Art is a Distant Early Warning system.", "footer":"McLuhan"}
]
</script>

    <script>
        const dataEl = document.getElementById('deck-data');
        let deck = JSON.parse(dataEl.innerText);

        const operators = [
            "Invert the hierarchy.", "Add a delay.", "Remove the goal.", "Observe the silence.",
            "Change the scale.", "Make it physical.", "Cut 30%.", "Focus on the frame.",
            "Swap roles.", "Increase the noise.", "Lower the resolution.", "Flatten the space.",
            "Wait.", "Repeat the error.", "Simplify the interface.", "Ask the youngest person.",
            "Look at the back.", "Discard the primary tool.", "Introduce a random element.",
            "Move to the basement.", "Work at night.", "Stop talking.", "Draw it.",
            "Identify the ghost.", "Whose profit is this?", "Make it heavy.", "Make it fragile.",
            "Is it a joke?", "Perform it as a dance.", "Translate it into a dead language.",
            "Write a letter to the founder.", "Open the window.", "Close your eyes.",
            "Count the steps.", "What is the opposite?", "Double the price.", "Give it away.",
            "Burn the prototype.", "Start over.", "Use more ink.", "Use less ink."
        ];

        // Ensure deck reaches exactly 120
        while (deck.length < 120) {
            const id = (deck.length).toString().padStart(3, '0');
            const msg = operators[(deck.length - 56) % operators.length];
            deck.push({
                id: id,
                type: "OPERATOR",
                icon: "⊙",
                title: "SYSTEM PROBE",
                body: msg,
                footer: "[ SYSTEM OPERATOR ]"
            });
        }

        const app = {
            shuffled: [...deck],
            cursor: 0,

            init() {
                this.shuffle();
                this.renderAll();
            },

            shuffle() {
                for (let i = this.shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [this.shuffled[i], this.shuffled[j]] = [this.shuffled[j], this.shuffled[i]];
                }
                this.cursor = 0;
                this.updateMobile();
            },

            draw() {
                this.cursor = (this.cursor + 1) % this.shuffled.length;
                const flipper = document.getElementById('mobile-flipper');
                if (flipper) flipper.classList.remove('flipped');
                setTimeout(() => this.updateMobile(), 100);
            },

            updateMobile() {
                const card = this.shuffled[this.cursor];
                const flipper = document.getElementById('mobile-flipper');
                if (!flipper) return;

                flipper.innerHTML = `
                <div class="card-face">${this.getFrontHTML(card)}</div>
                <div class="card-face card-back">${this.getBackHTML(card)}</div>
            `;
                const counter = document.getElementById('deck-counter');
                if (counter) counter.innerText = `UNIT ${(this.cursor + 1).toString().padStart(3, '0')} / 120`;
            },

            getFrontHTML(card) {
                return `
                <div class="card-id">#${card.id}</div>
                <div class="card-badge">${card.icon} ${card.type}</div>
                <div class="card-title">${card.title}</div>
                <div class="card-body">${card.body}</div>
                <div class="card-footer">${card.footer}</div>
            `;
            },

            getBackHTML(card) {
                return `
                <div class="back-logo">(( ◉ ))</div>
                <div class="back-text">DEW LINE</div>
                <div class="back-type-label">${card.icon} ${card.type}</div>
                <div style="font-size: 8px; margin-top: 20px; font-family: monospace; letter-spacing: 1px;">UNIT ${card.id}</div>
            `;
            },

            renderAll() {
                const fContainer = document.getElementById('fronts-container');
                const bContainer = document.getElementById('backs-container');
                const foldGrid = document.getElementById('fold-grid');

                if (fContainer) fContainer.innerHTML = '';
                if (bContainer) bContainer.innerHTML = '';

                // 4-Up Layout
                for (let i = 0; i < deck.length; i += 4) {
                    const chunk = deck.slice(i, i + 4);

                    if (fContainer) {
                        const fPage = document.createElement('div');
                        fPage.className = 'print-page';
                        chunk.forEach(c => {
                            const el = document.createElement('div');
                            el.className = 'card-face';
                            el.innerHTML = this.getFrontHTML(c);
                            fPage.appendChild(el);
                        });
                        fContainer.appendChild(fPage);
                    }

                    if (bContainer) {
                        const bPage = document.createElement('div');
                        bPage.className = 'print-page';
                        // Mirror indices for duplex: [1, 0, 3, 2]
                        const mirrorIndices = [1, 0, 3, 2];
                        mirrorIndices.forEach(idx => {
                            const c = chunk[idx];
                            const el = document.createElement('div');
                            el.className = 'card-face card-back';
                            if (c) el.innerHTML = this.getBackHTML(c);
                            else el.style.border = 'none';
                            bPage.appendChild(el);
                        });
                        bContainer.appendChild(bPage);
                    }
                }

                // 2-Up Foldable
                if (foldGrid) {
                    let foldHtml = '';
                    deck.forEach(c => {
                        foldHtml += `
                        <div class="fold-pair">
                            <div class="card-face">${this.getFrontHTML(c)}</div>
                            <div class="card-face card-back" style="border-left: none;">${this.getBackHTML(c)}</div>
                        </div>`;
                    });
                    foldGrid.innerHTML = foldHtml;
                }

                // Export Data
                const jsonBox = document.getElementById('json-export');
                if (jsonBox) {
                    jsonBox.innerText = JSON.stringify(deck, null, 2);
                }
            }
        };

        function showView(event, v) {
            document.querySelectorAll('.view-panel').forEach(p => p.classList.remove('active'));
            const panel = document.getElementById(v);
            if (panel) panel.classList.add('active');

            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        window.onload = function () {
            app.init();
        };
    </script>
</body>

</html>