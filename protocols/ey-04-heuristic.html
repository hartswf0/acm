<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EXPLAIN YOURSELF: Psychometric Analysis</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Courier Prime for that "Report" feel, Inter for UI -->
    <link
        href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Inter:wght@400;600;800&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            -webkit-print-color-adjust: exact;
        }

        .font-mono {
            font-family: 'Courier Prime', monospace;
        }

        /* Print Specific Styles */
        @media print {
            @page {
                margin: 0.5cm;
                size: portrait;
            }

            .no-print {
                display: none !important;
            }

            .print-only {
                display: block !important;
            }

            body {
                background-color: white;
            }

            .card-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 2px;
                page-break-inside: avoid;
            }

            .page-break {
                page-break-after: always;
            }

            .print-card {
                border: 1px dashed #999;
                height: 3.5in;
                /* Poker card height approx */
                padding: 1rem;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
        }

        .print-only {
            display: none;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- DATA SETS ---

        const evidenceDeck = [
            { id: "E-01", name: "Industrial Tub of Mayo", type: "Evidence", schema: "Viscosity", flavor: "Visceral repulsion. Acoustic squelch." },
            { id: "E-02", name: "Baby Oil (Family Size)", type: "Evidence", schema: "Viscosity", flavor: "Lubrication without an infant." },
            { id: "E-03", name: "Vaseline (Petroleum Jelly)", type: "Evidence", schema: "Viscosity", flavor: "The lonely Friday night." },
            { id: "E-04", name: "A Single Cucumber", type: "Evidence", schema: "Biological", flavor: "Specificity implies intent." },
            { id: "E-05", name: "Box of Tissues (Ultra Soft)", type: "Evidence", schema: "Biological", flavor: "The aftermath of an event." },
            { id: "E-06", name: "Eggplant", type: "Evidence", schema: "Biological", flavor: "The Emoji Code." },
            { id: "E-07", name: "Whipped Cream (Can)", type: "Evidence", schema: "Viscosity", flavor: "Food fetish or propellant abuse." },
            { id: "E-08", name: "Hand Lotion", type: "Evidence", schema: "Viscosity", flavor: "Suspicious if holding a magazine." },
            { id: "E-09", name: "50 Feet of Nylon Rope", type: "Evidence", schema: "Restraint", flavor: "Camping or Abduction?" },
            { id: "E-10", name: "Duct Tape (Silver)", type: "Evidence", schema: "Restraint", flavor: "The sound of silence." },
            { id: "E-11", name: "Zip Ties (Large, Black)", type: "Evidence", schema: "Restraint", flavor: "Efficient hostage management." },
            { id: "E-12", name: "A Shovel", type: "Evidence", schema: "Disposal", flavor: "Gardening at 2 AM?" },
            { id: "E-13", name: "A Hacksaw", type: "Evidence", schema: "Disposal", flavor: "For cutting hard materials... or bones." },
            { id: "E-14", name: "Rubber Gloves (Yellow)", type: "Evidence", schema: "Disposal", flavor: "Avoiding fingerprints." },
            { id: "E-15", name: "Ski Mask (Balaclava)", type: "Evidence", schema: "Concealment", flavor: "Winter sports or bank robbery?" },
            { id: "E-16", name: "Binoculars", type: "Evidence", schema: "Surveillance", flavor: "Bird watching or stalking?" },
            { id: "E-17", name: "A Single Red Rose", type: "Evidence", schema: "Obsession", flavor: "Romance or delusional stalking?" },
            { id: "E-18", name: "Ticking Kitchen Timer", type: "Evidence", schema: "Precursor", flavor: "Baking or bomb mechanism?" },
            { id: "E-19", name: "Gallon of Bleach", type: "Evidence", schema: "Cleanup", flavor: "DNA destruction." },
            { id: "E-20", name: "Plastic Sheeting", type: "Evidence", schema: "Cleanup", flavor: "The Kill Room." },
            { id: "E-21", name: "Trash Bags (Heavy Duty)", type: "Evidence", schema: "Disposal", flavor: "Taking out the 'trash'." },
            { id: "E-22", name: "Pressure Cooker", type: "Evidence", schema: "Precursor", flavor: "Chili or Shrapnel?" },
            { id: "E-23", name: "Sack of Fertilizer", type: "Evidence", schema: "Precursor", flavor: "Gardening or Anarchy?" },
            { id: "E-24", name: "Sudafed (Cold Meds)", type: "Evidence", schema: "Precursor", flavor: "Congestion or Cooking?" },
            { id: "E-25", name: "Bag of White Powder", type: "Evidence", schema: "Precursor", flavor: "Flour or Anthrax?" },
            { id: "E-26", name: "Baby Formula (Bulk)", type: "Evidence", schema: "Precursor", flavor: "Cutting agent." },
            { id: "E-27", name: "Meat Cleaver", type: "Evidence", schema: "Weapon", flavor: "Aggressive butchery." },
            { id: "E-28", name: "Sleeping Pills", type: "Evidence", schema: "Chemical", flavor: "The Cosby Schema." },
            { id: "E-29", name: "Polaroid Camera", type: "Evidence", schema: "Documentation", flavor: "Trophy taking." },
            { id: "E-30", name: "Cat Food (50 Cans)", type: "Evidence", schema: "Social", flavor: "Hoarding isolation." }
        ];

        const sceneDeck = [
            { id: "S-01", name: "TSA Security Checkpoint", type: "Scene", flavor: "High Authority. Zero tolerance." },
            { id: "S-02", name: "Primary School Playground", type: "Scene", flavor: "Stranger Danger active." },
            { id: "S-03", name: "A Funeral Home", type: "Scene", flavor: "Somber. Respect required." },
            { id: "S-04", name: "A Public Elevator", type: "Scene", flavor: "Forced intimacy. No escape." },
            { id: "S-05", name: "The Boss's Office", type: "Scene", flavor: "Career threatening." },
            { id: "S-06", name: "First Date (Fancy)", type: "Scene", flavor: "The 'Ick' factor." },
            { id: "S-07", name: "Confessional Booth", type: "Scene", flavor: "Sin vs. Crime." },
            { id: "S-08", name: "Public Restroom (Stall)", type: "Scene", flavor: "Acoustic privacy only." },
            { id: "S-09", name: "The Woods at Night", type: "Scene", flavor: "Shallow grave territory." },
            { id: "S-10", name: "An AA Meeting", type: "Scene", flavor: "Vulnerability breach." },
            { id: "S-11", name: "A Job Interview", type: "Scene", flavor: "Sanity check." },
            { id: "S-12", name: "Border Patrol Crossing", type: "Scene", flavor: "Trafficking checks." },
            { id: "S-13", name: "A Locker Room", type: "Scene", flavor: "Nudity and vulnerability." },
            { id: "S-14", name: "Grandma's House", type: "Scene", flavor: "Wholesome expectation." },
            { id: "S-15", name: "A Wedding Altar", type: "Scene", flavor: "'I Object' scenario." },
            { id: "S-16", name: "Crime Scene (Taped Off)", type: "Scene", flavor: "Returning to the scene." },
            { id: "S-17", name: "Kindergarten Show-and-Tell", type: "Scene", flavor: "Traumatizing the youth." },
            { id: "S-18", name: "Trunk of Your Car", type: "Scene", flavor: "The Abduction Schema." },
            { id: "S-19", name: "A Crowded Bus", type: "Scene", flavor: "Public safety threat." },
            { id: "S-20", name: "Hospital Waiting Room", type: "Scene", flavor: "Munchausen syndrome." }
        ];

        const accompliceDeck = [
            { id: "A-01", name: "The Sweaty Nervous Man", type: "Accomplice", flavor: "Physiological guilt cues." },
            { id: "A-02", name: "The 'Why?' Toddler", type: "Accomplice", flavor: "Radical honesty. Dismantles lies." },
            { id: "A-03", name: "The Mime", type: "Accomplice", flavor: "Uncanny silence. Mocking you." },
            { id: "A-04", name: "Over-Enthusiastic Intern", type: "Accomplice", flavor: "Verbalizes the conspiracy." },
            { id: "A-05", name: "The 'Wink-Wink' Guy", type: "Accomplice", flavor: "Frames your truth as a lie." },
            { id: "A-06", name: "The Girl Scout", type: "Accomplice", flavor: "Incongruous innocence. The Victim." },
            { id: "A-07", name: "The Identical Twin", type: "Accomplice", flavor: "The 'Evil Double' trope." },
            { id: "A-08", name: "The Conspiracy Theorist", type: "Accomplice", flavor: "Paranoia projection." },
            { id: "A-09", name: "The Stream Sniper", type: "Accomplice", flavor: "Live-streaming your shame." },
            { id: "A-10", name: "The Sleepwalker", type: "Accomplice", flavor: "Lack of agency. Zombie factor." }
        ];

        // --- COMPONENTS ---

        const Card = ({ data, color, rotate = false }) => (
            <div className={`relative flex flex-col justify-between p-4 rounded-xl shadow-lg border-2 border-black ${color} aspect-[2.5/3.5] transform transition-all duration-300 hover:scale-105`}>
                <div className="flex justify-between items-start">
                    <span className="font-mono text-xs font-bold opacity-70">{data.id}</span>
                    <span className="font-mono text-xs uppercase tracking-widest opacity-50">{data.type}</span>
                </div>
                <div className="text-center">
                    <h3 className="text-xl md:text-2xl font-bold leading-tight mb-2">{data.name}</h3>
                    <div className="w-8 h-1 bg-black mx-auto opacity-20 my-2"></div>
                </div>
                <div className="font-mono text-xs text-center opacity-80 italic">
                    "{data.flavor}"
                </div>
            </div>
        );

        const PrintCard = ({ data }) => (
            <div className="print-card border-2 border-black rounded-lg bg-white text-black p-4 flex flex-col justify-between h-[3.5in]">
                <div className="flex justify-between border-b-2 border-black pb-2">
                    <span className="font-mono font-bold">{data.id}</span>
                    <span className="font-mono uppercase">{data.type}</span>
                </div>
                <div className="flex-grow flex items-center justify-center text-center p-2">
                    <h2 className="text-xl font-bold">{data.name}</h2>
                </div>
                <div className="border-t-2 border-black pt-2 text-center">
                    <p className="font-mono text-xs italic">{data.flavor}</p>
                    <p className="font-mono text-[10px] mt-2 uppercase tracking-widest text-gray-500">Explain Yourself</p>
                </div>
            </div>
        );

        const Timer = ({ duration, onComplete, isActive }) => {
            const [timeLeft, setTimeLeft] = React.useState(duration);

            React.useEffect(() => {
                if (!isActive) return;
                setTimeLeft(duration);

                const interval = setInterval(() => {
                    setTimeLeft((prev) => {
                        if (prev <= 1) {
                            clearInterval(interval);
                            onComplete();
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);
                return () => clearInterval(interval);
            }, [isActive, duration]);

            return (
                <div className="w-full max-w-md mx-auto mb-6">
                    <div className="flex justify-between text-xs font-mono mb-1">
                        <span>COGNITIVE DISSONANCE INTERVAL</span>
                        <span className={timeLeft <= 3 ? "text-red-600 font-bold" : ""}>{timeLeft.toFixed(1)}s</span>
                    </div>
                    <div className="h-4 bg-gray-200 rounded-full overflow-hidden border border-gray-400">
                        <div
                            className={`h-full transition-all duration-1000 ease-linear ${timeLeft <= 3 ? 'bg-red-600' : 'bg-gray-800'}`}
                            style={{ width: `${(timeLeft / duration) * 100}%` }}
                        ></div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [mode, setMode] = React.useState('home'); // home, play, print
            const [hand, setHand] = React.useState(null);
            const [timerActive, setTimerActive] = React.useState(false);
            const [status, setStatus] = React.useState('idle'); // idle, thinking, panic
            const [includeAccomplice, setIncludeAccomplice] = React.useState(true);

            const dealHand = () => {
                const ev1 = evidenceDeck[Math.floor(Math.random() * evidenceDeck.length)];
                let ev2 = evidenceDeck[Math.floor(Math.random() * evidenceDeck.length)];
                while (ev1.id === ev2.id) {
                    ev2 = evidenceDeck[Math.floor(Math.random() * evidenceDeck.length)];
                }
                const sc = sceneDeck[Math.floor(Math.random() * sceneDeck.length)];
                const ac = includeAccomplice ? accompliceDeck[Math.floor(Math.random() * accompliceDeck.length)] : null;

                setHand({ ev1, ev2, sc, ac });
                setTimerActive(true);
                setStatus('thinking');
            };

            const handleTimerComplete = () => {
                setStatus('panic');
                setTimerActive(false);
            };

            // Print View Component
            if (mode === 'print') {
                return (
                    <div className="min-h-screen bg-white">
                        <div className="no-print p-6 bg-gray-800 text-white flex justify-between items-center sticky top-0 z-50 shadow-xl">
                            <div>
                                <h1 className="font-mono text-xl">LABORATORY PRINT MODE</h1>
                                <p className="text-xs opacity-70">Dr. Aris Thorne, PhD</p>
                            </div>
                            <div className="flex gap-4">
                                <button onClick={() => window.print()} className="bg-white text-black px-4 py-2 rounded font-bold hover:bg-gray-200 transition">PRINT DECKS</button>
                                <button onClick={() => setMode('home')} className="border border-white text-white px-4 py-2 rounded hover:bg-gray-700 transition">EXIT</button>
                            </div>
                        </div>

                        <div className="max-w-[8.5in] mx-auto p-4 space-y-8">

                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 1: EVIDENCE (1-9)</h2>
                                <div className="card-grid">
                                    {evidenceDeck.slice(0, 9).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>
                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 1: EVIDENCE (10-18)</h2>
                                <div className="card-grid">
                                    {evidenceDeck.slice(9, 18).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>
                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 1: EVIDENCE (19-27)</h2>
                                <div className="card-grid">
                                    {evidenceDeck.slice(18, 27).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>
                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 1: EVIDENCE (28-30) & SCENE (1-6)</h2>
                                <div className="card-grid">
                                    {evidenceDeck.slice(27, 30).map(c => <PrintCard key={c.id} data={c} />)}
                                    {sceneDeck.slice(0, 6).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>
                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 2: SCENE (7-15)</h2>
                                <div className="card-grid">
                                    {sceneDeck.slice(6, 15).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>
                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 2: SCENE (16-20) & ACCOMPLICE (1-4)</h2>
                                <div className="card-grid">
                                    {sceneDeck.slice(15, 20).map(c => <PrintCard key={c.id} data={c} />)}
                                    {accompliceDeck.slice(0, 4).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>
                            <div className="page-break">
                                <h2 className="text-center font-mono text-2xl mb-4 border-b-2 border-black pb-2">DECK 3: ACCOMPLICE (5-10)</h2>
                                <div className="card-grid">
                                    {accompliceDeck.slice(4, 10).map(c => <PrintCard key={c.id} data={c} />)}
                                </div>
                            </div>

                        </div>
                    </div>
                );
            }

            // Digital Game View
            if (mode === 'play') {
                return (
                    <div className="min-h-screen flex flex-col p-4 md:p-8 max-w-4xl mx-auto">
                        {/* Header */}
                        <div className="flex justify-between items-center mb-6">
                            <button onClick={() => setMode('home')} className="font-mono text-sm underline opacity-60 hover:opacity-100">‚Üê ABORT TEST</button>
                            <div className="text-right">
                                <div className="font-mono text-xs text-gray-500">SUBJECT NO. 8832</div>
                                <div className="font-mono text-xs font-bold text-red-600">RECORDING IN PROGRESS</div>
                            </div>
                        </div>

                        {/* Controls */}
                        {!hand ? (
                            <div className="flex-grow flex flex-col justify-center items-center space-y-8 text-center">
                                <div className="space-y-4 max-w-md">
                                    <h2 className="text-3xl font-bold font-mono">INITIATE TRIAL</h2>
                                    <p className="text-gray-600">The subject will be presented with a random configuration of objects and location. You have 10 seconds to construct a socially acceptable narrative.</p>

                                    <div className="flex items-center justify-center gap-2 p-4 bg-white rounded-lg shadow-sm border border-gray-200 cursor-pointer" onClick={() => setIncludeAccomplice(!includeAccomplice)}>
                                        <div className={`w-4 h-4 rounded-sm border ${includeAccomplice ? 'bg-black border-black' : 'border-gray-400'}`}></div>
                                        <span className="font-mono text-sm">INCLUDE ACCOMPLICE (HARD MODE)</span>
                                    </div>
                                </div>
                                <button
                                    onClick={dealHand}
                                    className="bg-black text-white px-8 py-4 rounded-lg font-mono text-xl shadow-xl hover:scale-105 transition-transform"
                                >
                                    GENERATE STIMULUS
                                </button>
                            </div>
                        ) : (
                            <div className="flex-grow flex flex-col">
                                <Timer duration={10} onComplete={handleTimerComplete} isActive={timerActive} />

                                {status === 'panic' && (
                                    <div className="text-center animate-pulse mb-4">
                                        <h1 className="text-4xl md:text-6xl font-black text-red-600 font-mono tracking-tighter">EXPLAIN YOURSELF!</h1>
                                    </div>
                                )}

                                {/* Cards Layout */}
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                                    <Card data={hand.ev1} color="bg-white" />
                                    <Card data={hand.ev2} color="bg-white" />
                                    <Card data={hand.sc} color="bg-gray-200" />
                                    {hand.ac ? (
                                        <Card data={hand.ac} color="bg-red-50" />
                                    ) : (
                                        <div className="border-2 border-dashed border-gray-300 rounded-xl flex items-center justify-center">
                                            <span className="font-mono text-xs text-gray-400 rotate-45">NO ACCOMPLICE</span>
                                        </div>
                                    )}
                                </div>

                                <div className="mt-auto flex justify-center gap-4">
                                    <button
                                        onClick={dealHand}
                                        className="bg-black text-white px-6 py-3 rounded-lg font-mono shadow-lg hover:bg-gray-800 transition"
                                    >
                                        NEXT TRIAL
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            // Home / Landing View
            return (
                <div className="min-h-screen flex flex-col justify-center items-center p-6 text-center max-w-2xl mx-auto">
                    <div className="mb-8 border-b-4 border-black pb-4 w-full">
                        <h1 className="text-4xl md:text-6xl font-black tracking-tighter mb-2">EXPLAIN YOURSELF</h1>
                        <p className="font-mono text-sm md:text-base text-gray-600">A Psychometric Analysis of Emergent Taboo</p>
                    </div>

                    <div className="space-y-6 text-left font-serif text-lg leading-relaxed text-gray-800 mb-10">
                        <p>
                            <span className="font-bold">Dr. Aris Thorne:</span> "The human brain abhors randomness. When presented with two objects and a location, you will invariably triangulate a narrative. Due to evolutionary negativity bias, that narrative defaults to the criminal or perverse."
                        </p>
                        <p>
                            Your goal is to fight the "Suspicion Heuristic." You have 10 seconds to create a benign schema that explains the evidence.
                        </p>
                    </div>

                    <div className="grid gap-4 w-full md:w-auto">
                        <button
                            onClick={() => setMode('play')}
                            className="bg-black text-white px-8 py-4 rounded font-mono text-xl shadow-lg hover:bg-gray-800 transition flex items-center justify-center gap-2"
                        >
                            <span>‚ñ∂</span> BEGIN EXPERIMENT (MOBILE)
                        </button>
                        <button
                            onClick={() => setMode('print')}
                            className="bg-white text-black border-2 border-black px-8 py-4 rounded font-mono text-xl shadow-lg hover:bg-gray-100 transition flex items-center justify-center gap-2"
                        >
                            <span>üñ®</span> PRINT PHYSICAL DECK
                        </button>
                    </div>

                    <div className="mt-12 text-xs font-mono text-gray-400">
                        ¬© 2024 Dr. Aris Thorne, PhD. Dept of Cognitive Deviance.
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>